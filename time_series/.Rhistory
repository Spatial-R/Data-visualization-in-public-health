install.packages("Amelia")
library("Amelia")
dat<-read.csv("596 INT.csv",header=T,stringsAsFactors = F);
head(dat)
dat[,c("smoking")]
names(dat)
dat<-read.csv("596 INT.csv",header=T,stringsAsFactors = F)[,c(48,322:355)];
head(dat)
dat.p<-melt(dat,id="smoking")
library(reshape);library(ggplot2)
dat.p<-melt(dat,id="smoking")
fix(dat.p)
head(dat.p)
dat.1p<-melt(dat[,1:10],id="smoking");dat.2p<-melt(dat[,c(1,11:19)],id="smoking")
dat.3p<-melt(dat[,c(1,20:28)],id="smoking");dat.4p<-melt(dat[,c(1,29:35],id="smoking")
dat.3p<-melt(dat[,c(1,20:28)],id="smoking");dat.4p<-melt(dat[,c(1,29:35)],id="smoking")
ggplot(dat.3p,aes(factor(factor(smoking),value)))+geom_boxplot()+
facet_grid(.~variable)
head(dat.1p)
ggplot(dat.3p,aes(factor(factor(smoking),value)))+geom_boxplot()+
facet_grid(~variable)
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_grid(~variable)
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_grid(~variable,ncol=3)
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(.~variable,ncol=3)
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=12,base_family = "serif")
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=12,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=14,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.1p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.2p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.4p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
names(dat)
k<-names(dat);names(dat)<-gsub("INT_","",k)
dat
head(dat)
dat.1p<-melt(dat[,1:10],id="smoking");dat.2p<-melt(dat[,c(1,11:19)],id="smoking")
dat.3p<-melt(dat[,c(1,20:28)],id="smoking");dat.4p<-melt(dat[,c(1,29:35)],id="smoking")
ggplot(dat.4p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.3p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.2p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
ggplot(dat.1p,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking")+ylab("")
dat.im<-dat[,c("cg09935388","cg09935388","cg26703534","cg05575921","cg14817490",
"cg25648203","cg21161138","cg03636183","cg10750182")]
ggplot(dat.im,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking status")+ylab("Methylation values")
dat.im<-dat[,c("smoking","cg09935388","cg09935388","cg26703534","cg05575921","cg14817490",
"cg25648203","cg21161138","cg03636183","cg10750182")]
dat.3p<-melt(dat.im,id="smoking")
ggplot(dat.im,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking status")+ylab("Methylation values")
dat.imp<-melt(dat.im,id="smoking")
ggplot(dat.imp,aes(factor(smoking),value))+geom_boxplot()+
facet_wrap(~variable,ncol=3)+theme_bw(base_size=16,base_family = "serif")+
xlab("Smoking status")+ylab("Methylation values")
library(dplyr);library(reshape);
AQI<-read.csv("AQI.csv",header=T,stringsAsFactors = F);
names(AQI)<-c("city","date","aqi","degree","pollutant1","pollutant2","pollutant3")
AQI<-filter(AQI,aqi>0);AQI<-mutate(AQI,date=as.Date(date));head(AQI)
setwd("E:/Github/Data-visualization-in-public-health/time_series")
library(dplyr);library(reshape);
AQI<-read.csv("AQI.csv",header=T,stringsAsFactors = F);
names(AQI)<-c("city","date","aqi","degree","pollutant1","pollutant2","pollutant3")
AQI<-filter(AQI,aqi>0);AQI<-mutate(AQI,date=as.Date(date));head(AQI)
AQI.HS<-dplyr::filter(AQI,city %in% c("杭州市","深圳市"))[,1:3]
AQI.HS$date <- as.double(as.POSIXct(AQI.HS$date,origin="1970-01-01"))
AQI.HS$city<-ifelse(AQI.HS$city=="杭州市","Hangzhou","Shenzheng")
r1 <- Rickshaw$new()
r1$layer(
aqi~ date,group="city",
data = AQI.HS,
type = "line"
)
r1$set(
slider = TRUE
)
library(rCharts)
AQI.HS$date <- as.double(as.POSIXct(AQI.HS$date,origin="1970-01-01"))
AQI.HS$city<-ifelse(AQI.HS$city=="杭州市","Hangzhou","Shenzheng")
r1 <- Rickshaw$new()
r1$layer(
aqi~ date,group="city",
data = AQI.HS,
type = "line"
)
r1$set(
slider = TRUE
)
r1
AQI.HS<-dplyr::filter(AQI,city %in% c("杭州市","深圳市"))[,1:3]
AQI.HS$date <- as.POSIXct(AQI.HS$date,origin="1970-01-01")
AQI.HS$city<-ifelse(AQI.HS$city=="杭州市","Hangzhou","Shenzheng")
r1 <- Rickshaw$new()
r1$layer(
aqi~ date,group="city",
data = AQI.HS,
type = "line"
)
r1$set(
slider = TRUE
)
r1
AQI.RC<-cast(AQI.HS,date~city);AQI.RC$date<-as.character(AQI.RC$date)
names(AQI.RC)<-c("date","Hangzhou","Shenzheng")
m1 <- mPlot(
x = "date", y = c("Hangzhou","Shenzheng"),
data = AQI.RC,
type = "Line"
)
m1$set( pointSize = 0, lineWidth = 1)
m1$set( hideHover = "auto" )
m1
as.POSIXlt(as.Date("2015-01-03"))
as.Date("2015-01-03")
AQI<-read.csv("AQI.csv",header=T,stringsAsFactors = F);
head(AQI)
library(dplyr)
AQI.HS<-dplyr::filter(AQI,city %in% c("杭州市","深圳市"))[,1:3]
names(AQI)<-c("city","date","aqi","degree","pollutant1","pollutant2","pollutant3")
AQI<-filter(AQI,aqi>0);AQI<-mutate(AQI,date=as.Date(date));head(AQI)
AQI.HS<-dplyr::filter(AQI,city %in% c("杭州市","深圳市"))[,1:3]
AQI.RC<-cast(AQI.HS,date~city);AQI.RC$date<-as.character(AQI.RC$date)
library(rehspae)
AQI.RC<-reshape::cast(AQI.HS,date~city);AQI.RC$date<-as.character(AQI.RC$date)
head(AQI.RC)
library(dygraphs);AQI.RC$date<-as.Date(AQI.RC$date)
dygraph(AQI.RC) %>%
dySeries("Hangzhou", label = "Hangzhou") %>%
dySeries("Shenzheng", label = "Shenzheng") %>%
dyOptions(stackedGraph = TRUE) %>%
dyRangeSelector(height = 20)
str(AQI.RC)
AQI.RC<-data.frame(AQI.RC);AQI.RC$date<-as.Date(AQI.RC$date)
head(AQI.RC)
str(AQI.RC)
dygraph(AQI.RC) %>%
dySeries("Hangzhou", label = "Hangzhou") %>%
dySeries("Shenzheng", label = "Shenzheng") %>%
dyOptions(stackedGraph = TRUE) %>%
dyRangeSelector(height = 20)
unique(AQI.RC$date)
duplicated(AQI.RC$date)
library(dygraphs)
lungDeaths <- cbind(mdeaths, fdeaths)
dygraph(lungDeaths)
lungDeaths
AQI.RC<-data.frame(AQI.RC);row.names(AQI.RC)<-as.Date(AQI.RC$date)
dygraph(AQI.RC)
head(AQI.RC)
